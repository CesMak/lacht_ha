# template:
#   sensors:
#     wp_betrieb_txt:
#       value_template: >
#         {% if is_state('sensor.wp_system_betriebsart', '0') %}
#           AUTOMATIK
#         {% elif is_state('sensor.wp_system_betriebsart', '1') %}
#           HEIZEN
#         {% elif is_state('sensor.wp_system_betriebsart', '2') %}
#           KUEHLEN
#         {% elif is_state('sensor.wp_system_betriebsart', '3') %}
#           SOMMER
#         {% elif is_state('sensor.wp_system_betriebsart', '4') %}
#           STANDBY
#         {% elif is_state('sensor.wp_system_betriebsart', '5') %}
#           2.WEZ
#         {% else %}
#           {{ states('sensor.wp_system_betriebsart') }}
#         {% endif %}
#       friendly_name: "WP Betrieb"
template:
  sensor:
    - name: "wp_betrieb_txt"
      state: >-
        {% set value = states('sensor.wp_betrieb')|int() %}
        {% if value == 0 %}{% set modus = 'undefiniert' %}
        {% elif value ==  1 %}{% set modus = 'Relaistest' %}
        {% elif value == 2 %}{% set modus = 'Notaus' %}
        {% elif value == 3 %}{% set modus = 'Diagnose' %}
        {% elif value == 4 %}{% set modus = 'Handbetrieb' %}
        {% elif value == 5 %}{% set modus = 'Handbetrieb_Heizen' %}
        {% elif value == 6 %}{% set modus = 'Handbetrieb_Kühlen' %}
        {% elif value == 7 %}{% set modus = 'Manueller_Abtaubetrieb' %}
        {% elif value == 8 %}{% set modus = 'Abtauen' %}
        {% elif value == 9 %}{% set modus = 'WEZ2' %}
        {% elif value == 10 %}{% set modus = 'EVU_Sperre' %}
        {% elif value == 11 %}{% set modus = 'SG_tarif' %}
        {% elif value == 12 %}{% set modus = 'SG_maximal' %}
        {% elif value == 13 %}{% set modus = 'Tarifladung' %}
        {% elif value == 14 %}{% set modus = 'Erhöhterbetrieb' %}
        {% elif value == 15 %}{% set modus = 'Standzeit' %}
        {% elif value == 16 %}{% set modus = 'Standbybetrieb' %}
        {% elif value == 17 %}{% set modus = 'Spülbetrieb' %}
        {% elif value == 18 %}{% set modus = 'Frostschutz' %}
        {% elif value == 19 %}{% set modus = 'Heizbetrieb' %}
        {% elif value == 20 %}{% set modus = 'Warmwasserbetrieb' %}
        {% elif value == 21 %}{% set modus = 'Legionellenschutz' %}
        {% elif value == 22 %}{% set modus = 'Umschaltung_HZ_KU' %}
        {% elif value == 23 %}{% set modus = 'Kühlbetrieb' %}
        {% elif value == 24 %}{% set modus = 'Passive_Kühlung' %}
        {% elif value == 25 %}{% set modus = 'Sommerbetrieb' %}
        {% elif value == 26 %}{% set modus = 'Schwimmbad' %}
        {% elif value == 27 %}{% set modus = 'Urlaub' %}
        {% elif value == 28 %}{% set modus = 'Estrich' %}
        {% elif value == 29 %}{% set modus = 'Gesperrt' %}
        {% elif value == 31 %}{% set modus = 'Sperre_AT' %}
        {% elif value == 31 %}{% set modus = 'Sperre_Sommer' %}
        {% elif value == 32 %}{% set modus = 'Sperre_Winter' %}
        {% elif value == 33 %}{% set modus = 'Einsatzgrenze' %}
        {% elif value == 34 %}{% set modus = 'HK_Sperre' %}
        {% elif value == 35 %}{% set modus = 'Absenk' %}
        {% else %}{% set modus = 'undefiniert' %}
        {% endif %}
        {{ modus }}

    - name: "WP Heizkreis Betriebsart Text" #41103
      state: >-
        {% set value = states('sensor.WP_Heizkreis_Betriebsart')|int() %}
        {% if value == 0 %}{% set modus = 'Automatik' %}
        {% elif value ==  1 %}{% set modus = 'Komfort' %}
        {% elif value == 2 %}{% set modus = 'Normal' %}
        {% elif value == 3 %}{% set modus = 'Abesenkbetrieb' %}
        {% elif value == 4 %}{% set modus = 'Standby' %}
        {% else %}{% set modus = 'undefiniert' %}
        {% endif %}
        {{ modus }}

    - name: "WP Systembetriebsart Text" #40001
      state: >-
        {% set value = states('sensor.wp_systembetriebsart')|int() %}
        {% if value == 0 %}{% set modus = 'Automatik' %}
        {% elif value ==  1 %}{% set modus = 'Heizen' %}
        {% elif value == 2 %}{% set modus = 'Kühlen' %}
        {% elif value == 3 %}{% set modus = 'Sommer' %}
        {% elif value == 4 %}{% set modus = 'Standby' %}
        {% elif value == 5 %}{% set modus = '2. WEZ' %}
        {% else %}{% set modus = 'undefiniert' %}
        {% endif %}
        {{ modus }}

    - name: "WP Störung"
      state: >
        {% if is_state('sensor.wp_stoerungsfrei', '1') %}
          keine Störung
        {% elif is_state('sensor.wp_betrieb', '0') %}
          Störung
        {% else %}
          ERROR           
        {% endif %}

    - name: "wpst_jaz_tag"
      state: >
        {{ (float(states('sensor.WPST_Gesamt_Tag')) / float(states('sensor.WPST_Elektrisch_Tag')))|round(2) }}

    - name: "wpst_jaz_monat"
      state: >
        {{ (float(states('sensor.WPST_Gesamt_Monat')) / float(states('sensor.WPST_Elektrisch_Monat')))|round(2) }}
